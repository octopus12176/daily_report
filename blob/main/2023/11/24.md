## 2023/11/24（金）

## 取り組んだ課題

- タイピング練習
- RESTについて理解する
- テスト技法について学ぶ

## わかったこと

- テスト技法について学ぶ
  - ソフトウェアテスト技法とはなにか
    - ある特定の条件下においてソフトウェアの振る舞いを記録し、その記録を期待する結果と比較・検証するプロセスである⇒開発者の意図したとおりにプログラムが動くのか？をいくつかの具体的なテストケースを用いて検証して、期待通りに動かない箇所（バグ）を減らすプロセス
      - ソフトウェアの品質保証が目的
        - ソフトウェアの納品・リリース後に重大なバグが発覚してしまうと、損害賠償する必要がある
        - 不安定なアプリはアプリストアで上位不表示されないアルゴリズムが採用されている
        - どのようにして品質を保証するのか
          - 期待通りに動くテストケース（具体例）が多いほど信頼できるので、複数のテストケースを用意する
      - ソフトウェアテストの限界
        - 全ての数字の組み合わせを検証するのは現実的でない。「完璧なテストはできない」という前提を持ち、少しでも多くのバグを見つけるという姿勢で挑む
      - ソフトウェアテストの種類
        - ユニットテスト
          - メソッド単位のテスト
        - 総合テスト
          - メソッドの組み合わせテスト
        - UI/システムテスト
          - データベースやUI部品を組み合わせたテスト
    - ソフトウェアテスト技法とはなにか
      - なるべく少ないテストケースでなるべく多いバグを発見するための技術
        - ソフトウェアテストにおいては、テストケースが多いほどバグは発生しやすくなる。しかし、闇雲にテストケースを増やしても意味がない
  - 技法を学ぶ前の基礎知識
    - 網羅性とピンポイント
      - 網羅性
        - テストの抜け漏れをなるべくなくす
      - ピンポイント
        - 怪しいところえを入念に調べる
      - ソフトウェアテストもなるべく多くのバグを発見するには、テスト技法によってなるべく網羅性を確保しつつ、バグが潜んでいそうな箇所や、システムの機能的に特に重要ないところについては、他の箇所よりテストケースを増やして入念に調べる必要がある
      - 怪しいところを発見するには、テストの観点を広げる
        - ①具体的な例を考え、その例の「間」「逆」「類推」「外側」を考える
        - ②意地悪な条件を考える
        - ③自分が知っている「知っている」「当たり前」と思っていることこそ疑う
    - テスト設計とアプローチ
      - テスト設計アプローチには以下の２つがある。
        - 契約によるテスト
          - 事前条件の範囲内だけでテストを行うアプローチ
            - 事前条件とは
              - 渡される必要のある引数など、メソッド（ソフトウェアテストの用語ではモジュール）が正しく呼び出される際に満たすべき条件
        - 防御的テスト
          - 事前条件の範囲外もテストを行うアプローチ
    - 技法を学ぶ前の基礎知識のポイント
      - テスト技法をなるべく多くのバグを発見する手段であって、目的ではない
        - テスト技法だけではなくピンポイントでもバグを探していこう。2つのテストアプローチを意識できれば、テストの指針になる
  - 同値クラスと境界値テスト
    - 同値クラステスト
      - テスト的には同じ意味になる値のこと
    - 境界値テスト
      - 同値クラスの境界とその前後を調べるテスト
    - 欠陥の検出は1つずつ
      - テストを行う際には、欠陥は他の欠陥を隠すことに注意が必要
  - ドメイン分析テストとデシジョンテーブル
    - ドメイン分析テストとデシジョンテーブル
      - ソフトウェアは単純な論理だけでなく、複雑な論理も扱う必要がある
        - 単純な論理・・・スイッチを押したら表示、もう一度押したら非表示
        - 複雑な論理・・・書籍を4000円以上購入した離島以外に住む人は配送料無料
          - この2つの複雑さの違いは、「条件（変数）」の数の違いによる
            - 単純な論理・・・条件は「スイッチ」のみ
            - 複雑な論理・・・条件は「購入カテゴリ」「購入金額」「住所」の３つ
              - 条件が増えて論理が複雑になると、テストケースの漏れが発生しやすい
                - それを防ぐための2つの技法がドメイン分析テストとデシジョンテーブル
      - ドメイン分析テスト
        - 条件同士が相互作用を持つような場合。言い換えるなら複数の条件が数式で結ばれている場合に有効
      - デシジョンテーブル
        - 条件同士は独立していて、込み入った論理関係を整理する場合。言い換えるなら複数の条件が論理式で結ばれている場合に有効
    - ドメイン分析テストの4つのポイント
      - ドメイン分析テストを理解するには以下の「4つのポイント」の理解が必要
        | ポイント名             |   概要   | x >= 10の場合 | x > 10の場合 |
        | :---------------: | :------: | :---: | :---: |
        | on |  境界線上の値  |  10 |  10 |
        | off     |   境界線にない境界に隣接する値   | ９ |  11 |
        | in         | on/off以外のドメイン内側の値 |  15など | 15など |
        | out         | on/off以外のドメイン外側の値 |  5など | 5など |
      - offポイントは、onポイントがドメイン内ならドメイン外の隣接する値、onポイントがドメイン外ならドメイン内の隣接する値になる
    - 境界値テストとon/offポイント
      - 境界値テストは、onポイントとoffポイントのテストも言える
    - ドメインテストマトリクス
      - 今回やりたいのは、算数の点数 >= 60、算数の点数 + 国語の点数　>= 90という2つの条件を組み合わせて検証すること
        - 欠陥は他の欠陥を隠すので、検証箇所は一箇所にする必要もある
        - 着目する一つの変数だけonポイントとoffポイントを動かして、その他の変数はinポイントに入れておけば一つずつ検証することができる
        - これを網羅するにはドメインテストマトリクスを使う  
        
          | ケース | 算数の点数 | 国語の点数 | 算数の点数 >= 60 | 算数 + 国語 >= 90 | 結果 |
          |--------|------------|------------|------------------|-------------------|------|
          | 1      | 60以上     | 任意       | 満たす           | 満たす            | OK   |
          | 2      | 60以上     | 29以下     | 満たす           | 満たさない        | NG   |
          | 3      | 59以下     | 任意       | 満たさない       | 満たす            | NG   |
          | 4      | 59以下     | 30以下     | 満たさない       | 満たさない        | NG   |
          - ①条件（変数）をリストアップする
          - ②行に条件（変数）を入れて、on/off/inポイントの行をその中に入れる
          - ③一番下に期待される結果の行を入れる
          - ④一つの条件（変数）以外はinポイントにして、着目する条件のon/offポイントを検証する
        - ドメインテストマトリクスを使うと、列がそのままテストケースになることに注目
    - ドメイン分析テストのPoint
      - 複数の条件が式で表現できるなら、ドメイン分析テストのドメインテストマトリクスを用いて条件の相互作用をテストしよう。
    - デシジョンテーブルとは
      - 「書籍を4000円以上購入した離島以外に住む人は配送料無料」というケースについて考える
        - これは論理式で表すことができる。論理式はプログラミングならANDやORで表現することができる
          - 書籍を購入しているAND 4000円以上購入している AND 離島に住んでない
            - このケースをデシジョンテーブルで表現すると以下のようになる

              |                        | 1   | 2   | 3   | 4   | 5   | 6   | 7   | 8   |
              | :--------------------- | --- | --- | --- | --- | --- | --- | --- | --- |
              | 条件                   |     |     |     |     |     |     |     |     |
              | 書籍を購入している     | Yes | Yes | Yes | No  | Yes | No  | No  | No  |
              | 4000円以上購入している | Yes | Yes | No  | Yes | No  | Yes | No  | No  |
              | 離島に住んでない       | Yes | No  | Yes | Yes | No  | No  | Yes | No  |
              |                        |     |     |     |     |     |     |     |     |
              | アクション             |     |     |     |     |     |     |     |     |
              | 送料無料       | Yes | No  | No | No | No  | No  | No | No  |
            - 条件とその時の結果（アクション）をそれぞれ埋めていくことで書くことができる。今回は2値条件（Yes/No）が3つあるので、2の3乗で8通りの組み合わせがある
    - デシジョンテーブルの圧縮
      - 場合によっては網羅性を維持しつつ、デシジョンテーブルを圧縮することができる。
      - 条件分岐の順番が判明している、かつ順番が一定ならば圧縮が可能
    - デシジョンテーブルのポイント
      - 複数お条件がANDやORなどを使った論理式なとして表現できるなら、デシジョンテーブルを用いて組み合わせを抜けもれなく調べよう。デシジョンテーブルがコードの中身に応じて圧縮しよう
  - ペア構成テスト
    - 全ての条件の組み合わせをテストするのではなく、条件の全てのペアをテストする方法
      - 全てのペアとは？
        - 例：2値条件（0/1）が3つ（条件A,B,C）ある場合
          - 全ての組み合わせ⇒8通り
          - 全てのペア⇒「AとB」「AとC」「BとC」という3通りの条件の組み合わせそれぞれに、「0,0」「1,0」「1,1」の4通りの値
      - 全てのペアをテストすることである程度の網羅性が確保できる理由は？
        - ほとんどの欠陥はシングルモード欠陥とダブルモード欠陥にどちらか。
          - シングルモード⇒モジュールが正しく動かない欠陥
          - ダブルモード⇒2つのモジュールが組み合わさったときに生じる欠陥
        - 全てのペアを調べれば、シングルモード欠陥とダブルモード欠陥については網羅できることになるので、ある程度の網羅性を確保できる。ペア構成テストによって70~85%程度のバグを発見することが期待できる
    - 直交表
      - 全てのペアを抜けもれなく網羅する方法の一つ。
      - 「2値条件（0/1）が3つ（条件A,B,C）ある場合」を直交表で書くと以下

          |     | A   | B   | C   |
          | --: | :-- | :-- | :-- |
          |   1 | 0   | 0   | 0   |
          |   2 | 0   | 1   | 1   |
          |   3 | 1   | 0   | 1   |
          |   4 | 1   | 1   | 0   |
      - 直交表を使うと行がテストケースになり、直交表で作られたテストケースを使えば全てのペアを網羅することができる。
      - 直交表の中には全ての条件のペアにおいて「0,0」「0,1」「1,0」「1,1」が現れていることと、テストケースが4つまで減っていることに注目
    - 直交表の表記方法
      - 4行で2値条件が3つの場合は「L4(2^3)」と表現する
      - 9行で3値条件が4つの場合は「L9(3^4)」と表現する
      - ⑧行で2値条件が4つ、4値条件が1つの場合は「L8(2^4 4^1)」と表現する
    - 直交表の使い方
       - 直交表の使い方は以下のような流れになる
         - ①条件を全て洗い出す
         - ②各条件が取りうる値の数を求める
         - ③①②の条件に合う直交表を選ぶ、完全一致がないなら少し大きめを選ぶ
         - ④直交表にテスト対象の条件を当てはめる
    - ペア構成テストのポイント
      - 組み合わせの数が膨大になるときは、直交表を用いて全てのペアを調べよう。全てのペアをてすとしただけでは網羅性は不十分、重要な組み合わせやバグが潜んでいそうな組み合わせについては追加でテストを行う必要があることを忘れずに
  - 状態遷移テスト
    - 状態遷移テストとは
      - 状態遷移テストには目的に応じて2種類があり、簡単に全体を確認できる状態遷移図と、深く詳細を確認する状態遷移表がある
    - 状態遷移図
      - 状態遷移は大きく「状態」「遷移」「イベント」の3つがある。「イベント」は状態を遷移させるもののこと
      - 初期状態は黒丸（●）、終了状態は目玉印（◉）で表現する
      - ある状態でイベントが適用不可のことをN／A（Not Applicable）と呼ぶ
      - 状態遷移図は簡単な書き方で状態遷移の全体像を把握するのには便利だが、N/Aも含めて抜けもれなくテストケースを見出すのには向いてない
        - 状態遷移表を使って網羅的に検討する必要がある
    - 状態遷移表
      - 状態遷移表を使うことで、仕様の抜け漏れのチェックもすることができる
    - Nスイッチカバレッジ
      - 連続するN個のイベントや状態遷移を考慮に入れるテスト手法
        - 例えば、2スイッチカバレッジでは、あるイベントから次のイベントまでのシーケンスを検証する
    - 状態遷移図のポイント
      - 状態遷移図・状態遷移表・Nスイッチカバレッジのテストを、それぞれの利用目的を理解した上で、求められる品質に応じて使い分けよう
  - カバレッジ
    - ブラックボックステストとホワイトボックステスト
      - カバレッジはホワイトボックスの考え方に基づいている
      - ブラックボックステストとホワイトボックステスト
        - ソフトウェアテストはテストケースの作り方によって大きく2種類に分かれる
        - ブラックボックステスト
          - ソフトウェアのコード内部のロジックを考慮せず、外部から見たときの仕様のみからテストケースを作成する
          - プログラミングの知識夜も業務に関する知識が必要
        - ホワイトボックステスト
          - コード内部のロジックを考慮してテストケースを作成する
          - ロジックなどを読み取れる必要があるので、ある程度プログラミングの知識が必要
    - データフローテスト
      - それぞれの変数において、「生成⇒使用⇒廃棄」というサイクルを確認するテスト
      - 変数を生成していないのに使用していないか？生成しているのに使用していない変数はないか？など、変数ごとに生成⇒使用⇒廃棄の順番が守られているかを確認する
    - 制御フローテスト
      - コード中の処理がどれだけ実行されたかを基準に行うテスト
        - 例えば、100行のコメントのコードがあった場合、100行全てが一度は実行されるようにテストケースを設計する、もしくは100行のうち何%が実行されたかに注目してテストを行うのが制御フローテスト
    - カバレッジとは
      - テスト可能なコードのうち、実際にテストされたコードの割合のこと
      - カバレッジは「実行された行数/実行可能な行数」という式以外にも、テスト網羅性の高さ（カバレッジレベル）ごとにいくつか求め方が存在している
       - 代表的なものとしては、以下5つのカバレッジレベルである
         - ステートメントカバレッジ
         - デシジョンカバレッジ
         - コンディションカバレッジ
         - 複合コンディションカバレッジ
         - MC/DCカバレッジ
    - レベル1：命令網羅（statment coverage）
      - 実行可能な行のうち何行を実行したか、で求められるカバレッジレベル。C0とも表記される
      - ステートメントカバレッジの網羅率（%） = 実行した行数 ÷ 実行可能な行数 × 100
    - レベル2：判定網羅（decision coverage）
      - 判定の分岐をどれだけ網羅したか、で求められるカバレッジレベル。分岐網羅（branch coverage）とも呼ばれたり、C1とも表記されることもある
      - 実行した判定結果の数 ÷ 全ての判定の判定結果の合計数 × 100
    - レベル3：条件網羅（condition coverage）
      - 判定の中の条件式の真偽をどれだけ網羅したか、で求められるカバレッジレベル。C2とも表記される
      - コンディションカバレッジの網羅率（%） = 実行した条件式の結果の数 ÷ 全ての条件式の結果の合計数 × 100
    - レベル4：複合条件網羅（mutiple condition coverage）
      - 条件式の真偽の組み合わせをどれだけ網羅したか、で求められるカバレッジレベル。MOCとも表記される
      - 複合コンディションカバレッジの網羅率（%） = 実行した条件式の審真偽の組み合わせの数 ÷ 条件式の真偽の組み合わせの合計数 × 100
      - 100％複合コンディションカバレッジを達成できるといかが保証される
        - 100%ステートメントカバレッジ
        - 100%デシジョンカバレッジ
        - 100%コンディションカバレッジ
      - 条件式の数が2つならテストケースは4つ、3つなら8つというように、必要なテストケースが倍々で増えていくのが特徴。網羅性は申し分ないが、テストケースが必要以上に増えてしまう場合が多いため、実際には複合コンディションカバレッジのかわりにMC/DCカバレッジが使われる
    - レベル5：MC/DC（modified condition/ decision coverage）
      - 複合コンディションカバレッジを改良（modified）して、必要なテストケースの数を削減したカバレッジレベル
      - 100%MC/DCカバレッジは、条件式の真偽の組み合わを網羅することなく、100%デシジョン/コンディションカバレッジを達成するカバレッジレベル
      - MC/DCカバレッジでは判定の中の条件式それぞれが、単独で判定の結果を左右するようにテストケースを用意する必要がある
        - ANDなら一つでも条件式に偽があれば、判定も偽になるし、ORなら一つでも条件式に真があれば、判定も真になる
        - 条件式の数が1つ増えるごとにテストケースが倍になる、複合コンディションカバレッジとは異なり、MC/DCカバレッジなら、基本的に「条件式の数+1」の数だけテストケースを用意すればいい
      - 航空機ソフトウェアのテスト時に使用する網羅度して開発されたカバレッジ。航空機ソフトウェアの他にも、自動車システムや銀行システムなどのようなソフトウェアのバグ発生が、人命に関わる・社会的に大きな影響になるなど、ミッションクリティカルなソフトウェアに採用されるカバレッジレベル
    - カバレッジの特徴
      - ①カバレッジが高いからといって、品質を保証できているとは限らない
      - ②カバレッジを100%に近づけるほど、バグ検出の費用対効果が下がる
      - ③カバレッジの数値そのものがテストの目的にすり替わりがち
    - カバレッジの活用ポイント
      - ①テストケースはカバレッジではなく、テスト技法を考え方をもとに作成する
        - カバレッジはあくまでも、テスト技法の補助として使う。テスト技法を活用して用意したテストケースを行った上で、それでもまだカバレッジが低いならテストケースの追加を検討する
        - 具体的なテストの進め方
          - テスト技法を用いてテストケースを設計する⇒そのテストケースを実行してみてカバレッジを計算する⇒低いようならピンポイントの観点でテストケースを追加する
      - ②100%のカバレッジを目指せず、85%程度のカバレッジを「努力目標」にする
        - Googleでは85%ステートメントカバレッジが一つの目安
        - カバレッジをテスト終了の基準や、ソフトウェアの品質の基準にはせず、達成した方がいいけど、達成しなくともいい努力目標として活用しよう

## 感じたこと 
- テスト技法について学ぶ
  - カバレッジをテストの補助として使うという考えが新鮮だった。数あるテスト技法の中では今までに行ったこともないものもあったので、次にテストを作成する機会があれば本講座で新たに学んだテスト技法も含めて選定していきたい。

## 次やること

- JavaScript入門・完全版

## 勉強時間

- Today: 6.5h
- Total: 577.5h
